%% 
%% Copyright 2019-2020 Elsevier Ltd
%% 
%% This file is part of the 'CAS Bundle'.
%% --------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'CAS Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for cas-dc documentclass for 
%% double column output.

%\documentclass[a4paper,fleqn,longmktitle]{cas-dc}
\documentclass[a4paper,fleqn]{cas-sc}

%\usepackage[numbers]{natbib}
%\usepackage[authoryear]{natbib}
\usepackage[authoryear,longnamesfirst]{natbib}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{longtable}

%%%Author definitions
\def\tsc#1{\csdef{#1}{\textsc{\lowercase{#1}}\xspace}}
\tsc{WGM}
\tsc{QE}
\tsc{EP}
\tsc{PMS}
\tsc{BEC}
\tsc{DE}
%%%

% Uncomment and use as if needed
%\newtheorem{theorem}{Theorem}
%\newtheorem{lemma}[theorem]{Lemma}
%\newdefinition{rmk}{Remark}
%\newproof{pf}{Proof}
%\newproof{pot}{Proof of Theorem \ref{thm}}

\begin{document}
\let\WriteBookmarks\relax
\def\floatpagepagefraction{1}
\def\textpagefraction{.001}

% Short title
\shorttitle{Correspondence Analysis of Two-Mode Networks}

% Short author
%\shortauthors{O. Lizardo}

% Main title of the paper
\title [mode = title]{The Correspondence Analysis of Two-Mode Networks: Centrality and Positional Interpretations}                      
% Title footnote mark
% eg: \tnotemark[1]
%\tnotemark[1,2]

% Title footnote 1.
% eg: \tnotetext[1]{Title footnote text}
% \tnotetext[<tnote number>]{<tnote text>} 
%\tnotetext[1]{}

%\tnotetext[2]{.}


% First author
%
% Options: Use if required
% eg: \author[1,3]{Author Name}[type=editor,
%       style=chinese,
%       auid=000,
%       bioid=1,
%       prefix=Sir,
       %orcid=0000-0002-5405-3007,
%       facebook=<facebook id>,
%       twitter=<twitter id>,
%       linkedin=<linkedin id>,
%       gplus=<gplus id>]
\author[1]{Omar Lizardo}[orcid=0000-0001-7511-2910]

% Corresponding author indication
\cormark[1]

% Footnote of the first author
\fnmark[1]

% Email id of the first author
\ead{olizardo@soc.ucla.edu}

% URL of the first author
\ead[url]{http://olizardo.bol.ucla.edu/}

%  Credit authorship
\credit{Conceptualization of this study, Methodology, Software}

%Address/affiliation
\affiliation[1]{organization={University of California, Los Angeles},
    addressline={264 Haines Hall}, 
    city={Los Angeles},
    %citysep={},  Uncomment if no comma needed between city and postcode
     postcode={90095}, 
     state={CA},
     country={USA}}

 %Corresponding author text
\cortext[cor1]{Corresponding author}
%\cortext[cor2]{Principal corresponding author}

%Footnote text
\fntext[fn1]{This paper was written while the author was partially supported by National Science Foundation grant HNDS-R \#2214215.}
 % author as well.}
%\fntext[fn2]{Another author footnote, this is a very long footnote and
 % it should be a really long footnote. But this footnote is not yet
 % sufficiently long enough to make two lines of footnote text.}

% For a title note without a number/mark
%\nonumnote{This note has no numbers. In this work we demonstrate $a_b$
%  the formation Y\_1 of a new type of polariton on the interface
 % between a cuprous oxide slab and a polystyrene micro-sphere placed
 % on the slab.
 % }
% Here goes the abstract
\begin{abstract}
Lorem...
\end{abstract}

% Use if graphical abstract is present
% \begin{graphicalabstract}
% \includegraphics{figs/grabs.pdf}
% \end{graphicalabstract}

%Research highlights
\begin{highlights}
    \item 
    \item 
    \item 
\end{highlights}

% Keywords
% Each keyword is separated by \sep
\begin{keywords}
Generalized similarity \sep Duality \sep Two-mode networks \sep Correspondence Analysis
\end{keywords}

\maketitle
\newpage
\section{Introduction}
While not particularly common, using Correspondence Analysis---hereafter CA---in analyzing two-mode network data has had a somewhat rocky career in the social networks literature. Initially criticized by \citet{borgatti1997network} as a relatively limited and perhaps even inapplicable tool, CA has found various proponents who see it as an important component of the SNA arsenal for two-mode network data analysis, particularly regarding its ability to economically provide synoptic (e.g., ``joint'') graphical representations of structural connectivity patterns across the two-modes \citep{roberts2000correspondence, breiger2000tool, faust2005using}, with the primary aim being to use CA---or its variants like Multiple Correspondence Analysis (MCA)---to ``visually explore'' such networks \citep{d2014use}. This paper contributes to the stream of previous work applying CA to analyze two-mode data. Nevertheless, it departs from the already-mentioned previous efforts in emphasizing aspects of CA for two-mode data analysis in SNA that have not been as emphasized or treated in detail before, moving beyond the focus on data visualization. 

Particularly, I show that CA can be thought of as computing a kind of \textit{dual centrality} score on both modes---one related to but not mathematically equivalent to the Bonacich \citeyearpar{bonacich1991simultaneous} two-mode centrality----an approach that, as noted by \citet{van2021correspondence}, has been recently re-invented in some corners of network science under the guise of the ``economic complexity index'' \citep{hidalgo2009building, mealy2019interpreting}. With \citet{van2021correspondence}, I argue that this is a rather restricted interpretation of a more general ``dual centrality'' score that connects to the use of CA in some disciplines (e.g., ecology) as a method of \textit{ordination}---e.g., the discovery of latent one-dimensional orderings among a set of entities. This applies to conceptualizing the venerable connection between people and the groups they join \citep{breiger1974duality}.

I also show that CA can be interpreted as providing \textit{positional} information on people and groups. First, I show that there is a suggestive similarity between the scores obtained from the first dimension of the CA of the two-mode affiliation matrix (the aforementioned dual centrality score) and recent work on ``generalized relational similarity'' in two-mode networks \citep{kovacs2010generalized, lizardo2024two}. As such, CA recovers clusters of entities (e.g., people) linked by their similar patterns of connectivity to other similar entities in the other mode (e.g., groups). Second, drawing on recent work by \citet{van2021correspondence}, I show that the first \textit{two} CA dimensions provide information on the degree-weighted similarity of nodes in the same mode concerning their connections to nodes in the other mode. Thus, CA can be used as an approach to indirect ``community'' identification in two-mode networks that connects to the use of CA in some disciplines (e.g., computer and information science) as a \textit{clustering} method \citep{zha2001bipartite}---e.g., the discovery of sociometrically similar subsets of entities in affiliation networks. 

\subsection{Organization of the Paper}
The rest of the paper is organized as follows. In the next section, I motivate the use of CA as producing a type of Bonacich-style dual centrality via weighted iteration across the two modes of the affiliation matrix. This leads naturally to an abbreviated way of computing the same scores via singular value decomposition (SVD) of the (inverse degree-weighted) one-mode projection of the affiliation matrix. This approach is computationally and mathematically related but \textit{not} equivalent to the CA of the affiliation matrix, which results in the usual Bonacich scores. I then draw on recent work by \citet{van2021correspondence} to show the links between the ordering of nodes along the first CA dimension and Kovacs's generalized relational similarity, and the distance of nodes in the space formed by the first two dimensions and the connectivity-similarity between nodes across modes. In closing, I provide some pointers on how CA can be used as a method for structural (e.g., centrality and positional) analysis, independently of the usual emphasis on joint graphical displays and visual exploration. 

\section{Reflective Centralities in Two-Mode Networks}
In a highly cited piece, \citet{hidalgo2009building} motivated what they saw at the time as a novel way of ranking nodes in a two-mode network---effectively computing a version of two-mode centrality---using what they called at the time a ``reflective'' approach. Hidalgo and Hausmann's original empirical application was to the two-mode country-by-product networks, hence the original baptizing of their approach as ``economic complexity.'' Subsequent shows that there is no logical connection between the formal method and this particular application. As such, I introduce it here using the more intuitive---and classical from a social science perspective---case of the duality of persons and groups \citep{breiger1974duality}. 

If we are going to compute the centrality of nodes in a two-mode network, the most natural place to start is with the good old \textit{degree centrality} \citep{faust1997centrality}. A two-mode network composed of a set of people $P$ and their affiliation relations to a set of groups $G$ can be represented by an affiliation matrix $\mathbf{A}$ of dimensions $|P| \times |G|$ with people along the rows and groups across the columns, where $|P|$ is the cardinality of the people set and $|G|$ is the cardinality of the group set, with cell entries $a_{pg}= 1$ if person \textit{p} is affiliated with group \textit{g} and $a_{pg}= 0$ otherwise. 

Given this, the degree-centrality of people is given by:

\begin{equation}
    C^R_p(1) = \sum_g a_{pg}
    \label{eq:R1_p}
\end{equation}

And for groups:

\begin{equation}
   C^R_g(1) = \sum_p a_{pg}
  \label{eq:R1_g}
\end{equation}

That is, the first-order centrality of people is the row sum of the entries in the affiliation matrix $A$, and the column sums of the same matrix give the first-order centrality of groups. As noted by \citet{hidalgo2009building}, the key to the reflective approach is the observation that, once we have these first-order quantities, it is possible to compute ``second-order centralities'' $C^R(2)$ for both people and groups using the (averaged) first-order centralities of the entities in the other mode they are connected to. 

For people, these are given by:

\begin{equation}
    C^R_p(2) = \frac{1}{C^R_p(1)}\sum_g a_{pg}C^R_g(1)
    \label{eq:R2_p}
\end{equation}

And for groups:

\begin{equation}
   C^R_g(2) = \frac{1}{C^R_g(1)}\sum_p a_{pg}C^R_p(1)
    \label{eq:R2_g}
\end{equation}

Equation \ref{eq:R1_p} says ``people are more central when the average sum of the memberships of the groups they belong to is large'' (e.g., whenever $a_{pg} = 1$ and $C^R_g(1)$ is a big number). Equation \ref{eq:R2_g} says ``groups are more central when the average sum of the number of memberships of their members is large'' (e.g., whenever $a_{pg} = 1$ and $C^R_p(1)$ is a big number). Of course, we can keep on going and define third-order reflections. 

For the people, these are given by:

\begin{equation}
   C^R_p(3) = \frac{1}{C^R_p(1)}\sum_g a_{pg}C^R_g(2)
   \label{eq:R3_p}
\end{equation}

And for groups:

\begin{equation}
   C^R_g(3) = \frac{1}{C^R_g(1)}\sum_p a_{pg}C^R_p(2)
   \label{eq:R3_g}
\end{equation}

Equation \ref{eq:R3_p} says something like ``people are more central when the average of the average number of memberships of the members of the groups they belong to is large'' (e.g., $a_{pg} = 1$ and $C^R_g(2)$ is a big number). Equation \ref{eq:R3_g} says, ''groups are more central when the average number of members of the groups their members belong to is large.'' (e.g., $a_{pg} = 1$ and $C^R_p(2)$ is a big number).

Note that for the people, the even-numbered reflection $C^R_p(2)$ assigns centrality based on a formal feature of the \textit{groups} they belong to (in this case, their degree centrality). On the other hand, the odd-numbered reflection $C^R_p(3)$ assigns centrality based on a formal feature of the \textit{members of the groups} they belong to. In the same way, for the groups, the even-numbered reflection $C^R_g(2)$ assigns centrality based on a formal feature of the \textit{people} who belong to them (in this case, their degree centrality). On the other hand, the odd-numbered reflection $C^R_g(3)$ assigns centrality based on a formal feature of the \textit{groups their members belong to}. While these are distinct metrics, in practice, the order of nodes in each mode ends up being identical when the ranks ``freeze'' after some number of iterations (proportional to the network size). 

More generally, \citet{hidalgo2009building} show that we can define a series of reflective quantities for people and groups (whose verbal and substantive interpretation becomes more complex as the number of iterations increases). 

For people, these are given by:

\begin{equation}   
    C^R_p(q) = \frac{1}{C^R_p(1)}\sum_g a_{pg}C^R_g(q-1) 
   \label{eq:Rq_p}
\end{equation}

And for groups:

\begin{equation}
   C^R_g(q) = \frac{1}{C^R_g(1)}\sum_p a_{pg}C^R_p(q-1)
   \label{eq:Rq_g}
\end{equation}

Equation~\ref{eq:Rq_p} says that the reflective centrality of person \textit{p} at iteration \textit{q} is the sum of the $q-1$ centralities of the groups they belong to ($C^R_g(q-1)$) divided by their number of memberships $C^{R}_p(1)$. Equation~\ref{eq:Rq_g} says that the $q^{th}$ group reflective centrality is the sum of $q-1$ centralities $C^R_p(q-1)$ of their members, divided by the number of group members $C^R_g(1)$.

\begin{table}
\caption{Southern Women Data.}
\label{tab:southern}
\begin{tabular}[]{lcccccccccccccc}
\hline
 & E1 & E2 & E3 & E4 & E5 & E6 & E7 & E8 & E9 & E10 & E11 & E12 & E13 & E14 \\
 \hline
EVELYN & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 \\
LAURA & 1 & 1 & 1 & 0 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
THERESA & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 \\
BRENDA & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
CHARLOTTE & 0 & 0 & 1 & 1 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
FRANCES & 0 & 0 & 1 & 1 & 1 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
ELEANOR & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
RUTH & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 \\
VERNE & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 1 & 0 & 0 \\
MYRA & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 1 & 0 & 0 \\
KATHERINE & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 1 & 1 & 1 \\
SYLVIA & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 1 \\
NORA & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 \\
HELEN & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 1 & 1 & 0 & 0 \\
OLIVIA & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 & 0 & 0 \\
FLORA & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 & 0 & 0 \\
PEARL & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 \\
DOROTHY & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 \\
\hline
\end{tabular}
\textsuperscript{Note: Rows ordered according to the generalized
blockmodeling solution of Doreian et al. (2004, Table 4).} \\
\end{table}

\subsection{Empirical Example}
Figure~\ref{fig:pg-reflections} shows the trajectory of the Hidalgo-Hausmann reflective centralities for persons (top panel) and groups (bottom panel) in the Southern Women data \citep{davis1941}, shown in Table~\ref{tab:southern}. The rank order of people and groups in the $q^{th}$ centrality is plotted in the y-axis, and the centrality iteration $q$ is plotted on the x-axis.

As the bottom panel of the figure shows, $NORA$, $FLORA$, $CHARLOTTE$, and $EVELYN$ are the top-ranked actors when it comes to $C^R_p(2)$:  The average number of members of the groups they belong to. However, their fates in this reflective metric diverge at higher reflections, with $NORA$ and $FLORA$ maintaining their top positions but $CHARLOTTE$ and $EVELYN$ tumbling down the ranks, suggesting that the members of the groups they belong to affiliate with smaller groups than the members of the groups $NORA$ and $FLORA$ belong to (and so on for higher reflections). Notably, the reflective centrality rankings after freezing ($q \geq 18$) recover the Doreian et al. (2004) block partition (see Table~\ref{tab:southern}), but this time with Dorothy and Pearl in the middle separating the two largest blocks of women. 

The bottom panel of Figure~\ref{fig:pg-reflections} shows the corresponding bump chart for the events. Just like for these actors, the equilibrium reflective centralities recover the ordering of the columns according to Doreian et al. generalized blockmodel with events 1-6 separated from events 10-15 by events 7-9 (see also \citet{kovacs2010generalized}). Figure~\ref{fig:pg-reflections} shows that $E14$ experiences the most dramatic improvement in status as we move to higher reflections. Relatively low ranked when it comes to the average number of memberships of its members, it increases in standing when considering the average of the average number of memberships of its members (and so forth). 

\begin{figure}
    \centering
    \includegraphics[width=0.75\textwidth]{Plots/pg-reflections.jpg}
    \caption{Reflective centrality trajectories of persons and groups (even reflections).}
    \label{fig:pg-reflections}
\end{figure}
\section{Correspondence Analysis, Dual Centrality, and Communities in Two-Mode Networks}
The reader may ask what the point of going through all these reflective centralities, since \citet{bonacich1991simultaneous} already developed a dual conception of centrality in two-mode networks based on a very similar idea: Define the centralities of entities in one mode based on the centralities of entities in the other mode to which they are connected. In that paper, Bonacich also considered CA in passing but dismissed its application to centrality rankings. Instead, Bonacich noted that, in analyzing the Southern Women data shown in Table~\ref{tab:southern}, ``[r]ather than centrality, what they [CA scores] seem to capture is membership in the two cliques that attended two different sets of events'' \citeyearpar[164]{bonacich1991simultaneous}. 

As we will see, Bonacich was only half right. Indeed, the CA scores capture a version of ``clique'' (more accurately, community) membership, but they---particularly the first dimension---also capture a version of centrality in the most general sense of ranking nodes based on a meaningful criterion \citep{borgatti2006graph}. In fact, they capture the limit $(q \rightarrow \infty)$ of the reflective centralities discussed in the previous section \citep{mealy2019interpreting}. 

To see this, recall that the solutions to the following eigensystem give the Bonacich $(C^B)$ two-mode centralities:

\begin{equation}
    AC^B_p = \lambda C^B_g 
    \label{eq:bon1}
\end{equation}

\begin{equation}
    A^TC^B_g = \lambda C^B_p 
    \label{eq:bon2}
\end{equation}

Where $A$ is the original affiliation matrix. The unknown $C^B_g$ and $C^B_p$ scores can be obtained from the row and column eigenvectors of the affiliation matrix corresponding to the largest eigenvalue $\lambda$, as given by the usual SVD of the affiliation matrix. Importantly, as Faust \citeyearpar[170]{faust1997centrality} notes, it is possible to express Equations~\ref{eq:bon1} and~\ref{eq:bon2} in terms of person and group-specific centralities. 

For people, these are given by: 

\begin{equation}
    C^B_p = \frac{1}{\lambda}\sum_{g}a_{pg}C^B_g
    \label{eq:faust1}
\end{equation}

And for groups:

\begin{equation}
    C^B_g = \frac{1}{\lambda}\sum_{p}a_{pg}C^B_p
    \label{eq:faust2}
\end{equation}

These equations make clear that in the Bonacich two-mode centrality of people is proportional to centralities of the groups they join, and the centrality of groups is proportional to the centralities of their members. These capture the duality property since the centralities of nodes in each mode are given by aggregating their connections to nodes in the other mode. Note the formal similarity between equations~\ref{eq:faust1} and~\ref{eq:faust2} and equations~\ref{eq:Rq_p} and~\ref{eq:Rq_g}. The main difference is that in the reflective equations, a person's centrality is proportional to the \textit{activity-weighted} centralities of the groups they join, and a group's centrality is proportional to the \textit{group size weighted} centrality of the people who are members.

As noted by \citet{mealy2019interpreting} and \citet{van2021correspondence}, Hidalgo and Hausmann's \citeyearpar{hidalgo2009building} reflective centralities can also be obtained as the solution to an eigenvalue problem. To see this, recall that, as Bonacich \citeyearpar[157]{bonacich1991simultaneous} notes, we can solve for $C^B_g$ in~\ref{eq:bon2} and $C^B_p$ in~\ref{eq:bon1} and substitute the respective solutions into \ref{eq:bon1} and~\ref{eq:bon2}. Matrix-algebraic reduction of the resulting equations would show that the Bonacich dual centralities can also be obtained as solutions to the eigensystem:

\begin{equation}
    \left(AA^T\right)C^B_p = \lambda^2 C^B_p
    \label{eq:bon3}
\end{equation}

\begin{equation}
    \left(A^TA\right)C^B_g = \lambda^2 C^B_g
    \label{eq:bon4}
\end{equation}

Now, consider the $|P| \times |P|$ matrix $Dp$, which contains the ``first order'' reflective centralities of each person $C^R(1)_p$ (activity) along the diagonals and zeroes in every other cell. In the same way, consider the $|G| \times |G|$ matrix $Dg$, which contains the ``first order'' (degree) centralities of each group $C^R(1)_g$ (size) along the diagonals and zeroes in every other cell. It can be shown \citep{van2021correspondence}, that in the limit, the iterative Hidalgo-Hausmann \citeyearpar{hidalgo2009building} reflective centralities can be obtained as the solution of the eigensystem:

\begin{equation}
    \left(Dp^{-1}ADg^{-1}A^T\right)C^R_p = \lambda C^R_p
    \label{eq:dam1}
\end{equation}

\begin{equation}
    \left(Dg^{-1}A^TDp^{-1}A\right)C^R_g = \lambda C^R_g
    \label{eq:dam2}
\end{equation}

Note the formal similarity (and key differences) between these equations and the Bonacich two-mode centralities in equations~\ref{eq:bon3} and~\ref{eq:bon4}. Both extract individual and group centralities as eigenvectors of the one-mode projection of the original affiliation matrix: $AA^T$ for people and $A^TA$ for groups. The difference is that the reflective centralities pre-multiply the affiliation matrix and its transpose by the inverse of the first-order centralities of the nodes in each mode, essentially weighting the projection by node degree before performing the SVD. 

This can be clearly seen if we express $\left(Dg^{-1}A^TDp^{-1}A\right)$ in~\ref{eq:dam1} in terms of each cell entry \cite[eq. 4]{mealy2019interpreting}:

\begin{equation}
    a_{pp'} = \sum_g\frac{a_{pg}a_{p'g}}{C^R_p(1)C^R_g(1)} = 
    \frac{1}{C^R_p}\sum_g\frac{a_{pg}a_{p'g}}{C^R_g(1)}
    \label{eq:mealy1}
\end{equation}

In equation~\ref{eq:mealy1}, the numerator is equal to one when person $p$ and person $p'$ share a membership. Summed across groups $g$, this gives the number of memberships that $p$ and $p'$ have in common \citep{breiger1974duality}. As noted, the Bonacich dual centralities are obtained from an SVD of this matrix of shared memberships (for people) and shared people (for groups). The reflective centralities, on the other hand, are obtained from an SVD of a weighted version of the same matrix, where the weights are the sizes of each of the groups $p$ shares with each other person summed across groups and divided by the total number of $p$'s memberships. 

The same reasoning applies to groups in~\ref{eq:dam2}, whose entries are given by:

\begin{equation}
    a_{gg'} = \sum_p\frac{a_{pg}a_{pg'}}{C^R_p(1)C^R_g(1)} = 
    \frac{1}{C^R_g}\sum_p\frac{a_{pg}a_{pg'}}{C^R_p(1)}
    \label{eq:mealy2}
\end{equation}

Now, as has been noted by two-mode data analysts in other contexts \citep[e.g.,][]{faust2005using} it turns out that this ``double-pre-weighting'' of each cell entry by the degrees of each mode (e.g., the row and column sums of the original affiliation matrix) is precisely that used before performing the SVD of a two-mode matrix to obtain the corresponding row and column scores in CA.\footnote{More accurately, cells are weighted by inverse of the square root of the product of the row and column sums \citep[e.g.,][124]{faust2005using}.} And indeed, as has recently been shown \citep{van2021correspondence}, the limit reflective centralities obtained from equations~\ref{eq:dam1} and~\ref{eq:dam2}---which will be given by the eigenvectors corresponding to the \textit{second} largest eigenvalue of the resulting solution---will be substantively equivalent to the row and column scores corresponding to the first non-trivial dimension (for people and groups respectively) obtained from a CA of the original affiliation matrix.\footnote{As \citet[126]{faust2005using}, the first non-trivial CA dimension is also given by the eigenvector corresponding to the second-largest eigenvalue of the SVD solution.} In fact, the method of ``reflections'' is just a re-discovery of the older idea of reciprocal averaging \citep{hill1973reciprocal}, which is yet another way of computing row and column scores for elements in a two-mode matrix that are substantively equivalent to those obtained by (the first non-trivial dimension of) CA \citep{mealy2019interpreting}.

Degree-pre-weighting does not radically alter the nature of the data. Indeed, it corresponds to moving from sums to averages, thus ``adjusting'' for the influence of person-activity and group size---a seemingly perenial issue in two-mode data analysis \citep[159ff]{bonacich1991simultaneous}. This can be seen by the fact that Equations~\ref{eq:mealy1} and~\ref{eq:mealy2} show that, substantively, what the degree pre-weighting does is that, for people, co-memberships count for more in determining interpersonal similarity when the group in question is small than when it is large. On the group side, shared members who do not have many affiliations count more in determining intergroup similarity than those with many affiliations. 

Accordingly, it would make no sense to call the Bonacich scores $C^B_p$ and $C^B_g$ from equations~\ref{eq:bon3} and~\ref{eq:bon4} ``centrality scores'' but fail to hold that designation from $C^R_p$ and $C^R_g$, given that the mathematics are not only ``similar'' \citep[162]{bonacich1991simultaneous} but formally identical. In the Bonacich case, SVD of the one-mode projection of the two-mode network; in the reflective case, SVD of the degree-weighted one-mode projection of the same network. Accordingly, the CA of a two-mode network will return---along the first dimension---a rank-ordered score for nodes in each mode that meets all the conditions for qualifying as a centrality measure for two-mode networks. Particularly, the CA centrality retains the duality property \citep[128]{faust2005using}, as the (average) centrality of people is a function of the (average) centrality of the groups they belong to. The (average) centrality of groups, in turn, is a function of their members' (average) centrality. The person and group score ranks given by the first CA dimension are thus better thought of as \textit{activity and group-sized adjusted} versions of the familiar Bonacich \citeyearpar{bonacich1991simultaneous} dual centralities for two-mode networks.\footnote{Adjusted in the sense described earlier of giving more weight to smaller groups and people with fewer memberships.} 

\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{Plots/ca-v-bon-reord.png}
    \caption{Southern Women Affiliation matrix with re-ordered rows and columns: (a) row and columns re-ordered according to first CA dimension, (b) row and columns re-ordered according to Eigenvector centrality.}
    \label{fig:ca-v-bon}
\end{figure}

Figure~\ref{fig:ca-v-bon} illustrates the differences between $C^R$ and $C^B$. Each panel shows the original Southern Women affiliation matrix but with rows and columns re-ordered according to the first CA dimension (a) and the \citet{bonacich1991simultaneous} centrality (b). In the plot, a square is colored red if it has a one in the affiliation matrix and is colored white if it has a zero. As we can see, the two row-column-reshuffled matrices have appreciably distinct structures, with the $C^R$ re-ordered affiliation matrix having a block-diagonal structure and the $C^B$ re-ordered affiliation matrix having a triangular structure. 

Accordingly, the $C^R$ centrality rankings reveal a dual community partition between groups of women who selectively attend two groups of events (on the top-right and bottom-left of the plot). The traditional eigenvector centrality re-ordering, on the other hand, reveals a classic core-periphery partitioning \citep{borgatti2000models}, with a group of highly active women (on the bottom-right) who selectively co-participate in highly attended events (on the lower right-hand side of the plot) and less active women (in the upper half) who go to less well-attended events (on the right side). The two centralities extract qualitatively different information from the two-mode network, with $C^R$ geared toward community partitioning and $C^B$ more focused on finding a core of well-connected people and groups. 

We can confirm that the first CA axis points toward the underlying partitioning of the two-mode network by looking at Figure~\ref{fig:eigvec}, which shows the $C^R$ score of persons and groups on the x-axis against the score's rank order on the y-axis. If a two-mode network has no discernible community structure, the first dimension CA scores would be distributed as a continuous logistic curve; when community structure is present, we should observe discernible breaks in this distribution \citep{van2021correspondence}. The Southern Women data clearly belong to the second category. In the people mode, we have $\left[Frances, Laura, Brenda, Charlotte, Evenly, Theresa, Elanor, Ruth\right]$ on one side, $\left[Nora, Katherine, Sylvia, Flora, Olivia, Myra, Helen, Verne\right]$ on the other, and  $\left[Pearl, Dorothy\right]$ in an ambiguous middle. Among events, we have $\left[E1, E2, E3, E4, E5, E6\right]$ on side $\left[E9, E10, E11, E12, E13, E14\right]$ on the other and $\left[E8, E9\right]$ in an ambiguous middle position. Note that this is roughly the same partitioning obtained by \citep{doreian2004generalized} and reproduced by \citet{kovacs2010generalized} and \citet{lizardo2024two} using a generalized relational similarity approach. 

\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{Plots/eigvec.png}
    \caption{Caption}
    \label{fig:eigvec}
\end{figure}

To further appreciate the links between CA, reflective centralities, and community partitioning in two-mode networks, note that $S_p = ADg^{-1}A^T$ in~\ref{eq:dam1} can be thought of as giving the similarity between pairs of people weighted by the size of the groups they belong to (so that people are more similar when they share smaller memberships). The same interpretation can be given to $S_g = A^TDp^{-1}A$ in~\ref{eq:dam2}, which is the similarity of groups weighted by the activity of the people in them (so that groups are more similar when they share members who do not belong to many other groups). As \citet{van2021correspondence} show, the eigenvectors corresponding to (the Laplacian\footnote{For the similarity matrix $S$, the Laplacian is defined as $D-S$ where $D$ is the matrix containing the degrees of either people or groups in the diagonal and zeroes in every other cell.} of) these similarity matrices are equivalent to $C^R$. These means that the relative spread of the eigenvalues of the similarity matrix Laplacian gives information concerning the quality of the resulting community partition. These are shown as inset plots in Figure~\ref{fig:eigvec} for both people and groups. Note that in both cases, the first two eigenvalues separate from the rest, strongly indicating a dual-community structure in the Southern Women two-mode network. 

\begin{figure}
    \centering
    \includegraphics[width=1.0\textwidth]{Plots/sim.png}
    \caption{Caption}
    \label{fig:ca-sim}
\end{figure}

To fix the intuition, the top-left panel (a) of Figure~\ref{fig:ca-sim} shows a heatmap representation of the group-size weighted similarity matrix $S_p$ (for people); the top-right panel (b) shows the same plot for the activity-weighted similarity matrix $S_g$ (for groups). In both figures, darker squares indicate more similar node pairs, and closer to the white indicate less similarity; also, the rows of each matrix are sorted according to $C^R$, namely, the scores for the first-non-trivial CA dimension (corresponding to the x-axis of the plots in Figure~\ref{fig:eigvec}) for people and groups. As we can see, for both people and groups, the re-ordered matrix recovers maximally similar communities of nodes, where the similarity is based on their shared (degree-weighted) connections to entities in the other mode. 

The bottom panel of Figure~\ref{fig:sim} shows the correspondence plot of the first two non-trivial dimensions of the CA of the two-mode network. Persons and groups are colored according to a six-cluster k-means solution based on the first nine eigenvectors of the respective similarity matrices. The plot reveals that the usual correspondence plot---usually taken to be a low-dimensional representation of the original affiliation matrix \citep{borgatti1997network}---is best thought of as a low-dimensional representation of the (other mode's) degree-weighted similarity network across people and groups. People with similar values in $S_p$ appear closer in the correspondence plot (and are assigned to the same cluster by the k-means algorithm), as do events with similar values in $S_g$.

Note that this differs from the usual interpretation of the CA correspondence plot, which is usually taken to bring together nodes with ``similar'' connectivity patterns, where similarity is presumed to imply (for instance) that two people attend the same set of events, or that two groups share the same set of members. What the CA correspondence plot distance captures is, instead, people and groups that are \textit{surprisingly} similar after taking people's activity levels and the sizes of the groups they belong to into account. Thus, people who share memberships in small groups will be closer in the diagram than people who share memberships in big groups. In the same way, groups that share people with few memberships will be closer in the diagram than those sharing people with many other memberships. 

\begin{figure}
    \centering
    \includegraphics[width=1.0\textwidth]{Plots/bon-sim.png}
    \caption{Caption}
    \label{fig:bon-sim}
\end{figure}

This ambiguity in interpretation may stem from the fact that CA is usually seen as a technique to generate a plot that provides a ``low-dimensional approximation to the input data'' \citep[125]{faust2005using}, where the ``input data'' is presumed to be the original affiliation matrix $\mathbf{A}$. But as we have seen, this is \textit{not} what CA is designed to do. Instead, CA is meant to provide a low-dimensional approximation of a \textit{transformed} version of the input data, where the transformation is meant to adjust for people's activity levels and group sizes. Oddly, if a low-dimensional representation of the original ``input data'' ($\mathbf{A}$) is what we are after, this may be more closely approximated by the first two dimensions of the SVD of this matrix. 

Figure~\ref{fig:bon-sim} shows the ``raw'' (unweighted) similarity scores for persons ($a_{pp'} = \sum_g a_{pg}a_{p'g}$) and groups ($a_{gg'} = \sum_p a_{pg}a_{pg'}$), with the rows and columns sorted by the first eigenvector of the matrix, which is the usual Bonacich centrality score. Both similarity matrices reproduce the triangular, core-periphery structure we observed in the re-ordered affiliation matrix on the top-right panel of Figure~\ref{fig:ca-v-bon}. The bottom panel of the figure plots $C^B$ on the x-axis against the second eigenvector of the SVD solution---a relatively unusual but not substantively unmotivated practice \citep{iacobucci2017eigenvector}.\footnote{Nodes are colored to a four-cluster k-means solution using the first six eigenvectors of the respective similarity matrices.} 

We can see that the plot of the first two SVD dimensions of $\mathbf{A}$ do a good job of recovering the ``raw'' connectivity structure of the network, partitioning the ``core'' persons and groups (on the lower-right) from the more peripheral ones (on the upper left). Moreover, if we are all interested in capturing a low-dimensional representation of which people have particular affinities for which events (regardless of people's activity levels or group sizes), then this plot does a better job showing that than the usual CA correspondence plot in the bottom half of Figure~\ref{fig:ca-sim} For instance, $\left[Flora, Olivia\right]$ do have a special affinity for $\left[E11\right]$ and $\left[Nora, Katherine\right]$ for $\left[E10, E12, E13, E14\right]$. In the same way, core events like $\left[E8, E9, E10\right]$---shown on the upper side of the plot---are different from core events $\left[E3, E4, E5, E6\right]$---shown in the lower quadrant. The former are more inclusive of peripheral members while the latter are more ``cliquish,'' including only core members. Conversely, $\left[E1, E2]\right]$, although as poorly attended as other peripheral events, tend to include core members and thus appear closer to those actors in the bottom half of the plot. 
%% Loading bibliography style file
%\bibliographystyle{model1-num-names}
\bibliographystyle{cas-model2-names}
% Loading bibliography database
\bibliography{ca.bib}
\end{document}


The Elsevier cas-dc class is based on the
standard article class and supports almost all of the functionality of
that class. In addition, it features commands and options to format the
\begin{itemize} \item document style \item baselineskip \item front
matter \item keywords and MSC codes \item theorems, definitions and
proofs \item labels of enumerations \item citation style and labeling.
\end{itemize}

This class depends on the following packages
for its proper functioning:

\begin{enumerate}
\itemsep=0pt
\item {natbib.sty} for citation processing;
\item {geometry.sty} for margin settings;
\item {fleqn.clo} for left aligned equations;
\item {graphicx.sty} for graphics inclusion;
\item {hyperref.sty} optional packages if hyperlinking is
  required in the document;
\end{enumerate}  

All the above packages are part of any
standard \LaTeX{} installation.
Therefore, the users need not be
bothered about downloading any extra packages.

\section{Installation}

The package is available at author resources page at Elsevier
(\url{http://www.elsevier.com/locate/latex}).
The class may be moved or copied to a place, usually,\linebreak
\verb+$TEXMF/tex/latex/elsevier/+, %$%%%%%%%%%%%%%%%%%%%%%%%%%%%%
or a folder which will be read                   
by \LaTeX{} during document compilation.  The \TeX{} file
database needs updation after moving/copying class file.  Usually,
we use commands like \verb+mktexlsr+ or \verb+texhash+ depending
upon the distribution and operating system.

\section{Front matter}

The author names and affiliations could be formatted in two ways:
\begin{enumerate}[(1)]
\item Group the authors per affiliation.
\item Use footnotes to indicate the affiliations.
\end{enumerate}
See the front matter of this document for examples. 
You are recommended to conform your choice to the journal you 
are submitting to.

\section{Bibliography styles}

There are various bibliography styles available. You can select the
style of your choice in the preamble of this document. These styles are
Elsevier styles based on standard styles like Harvard and Vancouver.
Please use Bib\TeX\ to generate your bibliography and include DOIs
whenever available.

Here are two sample references: 
\cite{Fortunato2010}
\cite{Fortunato2010,NewmanGirvan2004}
\cite{Fortunato2010,Vehlowetal2013}

\section{Floats}
{Figures} may be included using the command,\linebreak 
\verb+\includegraphics+ in
combination with or without its several options to further control
graphic. \verb+\includegraphics+ is provided by {graphic[s,x].sty}
which is part of any standard \LaTeX{} distribution.
{graphicx.sty} is loaded by default. \LaTeX{} accepts figures in
the postscript format while pdf\LaTeX{} accepts {*.pdf},
{*.mps} (metapost), {*.jpg} and {*.png} formats. 
pdf\LaTeX{} does not accept graphic files in the postscript format. 

\begin{figure}
	\centering
		\includegraphics[scale=.75]{figs/Fig1.pdf}
	\caption{The evanescent light - $1S$ quadrupole coupling
	($g_{1,l}$) scaled to the bulk exciton-photon coupling
	($g_{1,2}$). The size parameter $kr_{0}$ is denoted as $x$ and
	the \PMS is placed directly on the cuprous oxide sample ($\delta
	r=0$, See also Table \protect\ref{tbl1}).}
	\label{FIG:1}
\end{figure}


The \verb+table+ environment is handy for marking up tabular
material. If users want to use {multirow.sty},
{array.sty}, etc., to fine control/enhance the tables, they
are welcome to load any package of their choice and
{cas-dc.cls} will work in combination with all loaded
packages.

\begin{table}[width=.9\linewidth,cols=4,pos=h]
\caption{This is a test caption. This is a test caption. This is a test
caption. This is a test caption.}\label{tbl1}
\begin{tabular*}{\tblwidth}{@{} LLLL@{} }
\toprule
Col 1 & Col 2 & Col 3 & Col4\\
\midrule
12345 & 12345 & 123 & 12345 \\
12345 & 12345 & 123 & 12345 \\
12345 & 12345 & 123 & 12345 \\
12345 & 12345 & 123 & 12345 \\
12345 & 12345 & 123 & 12345 \\
\bottomrule
\end{tabular*}
\end{table}

\section[Theorem and ...]{Theorem and theorem like environments}

{cas-dc.cls} provides a few shortcuts to format theorems and
theorem-like environments with ease. In all commands the options that
are used with the \verb+\newtheorem+ command will work exactly in the same
manner. {cas-dc.cls} provides three commands to format theorem or
theorem-like environments: 

\begin{verbatim}
 \newtheorem{theorem}{Theorem}
 \newtheorem{lemma}[theorem]{Lemma}
 \newdefinition{rmk}{Remark}
 \newproof{pf}{Proof}
 \newproof{pot}{Proof of Theorem \ref{thm2}}
\end{verbatim}


The \verb+\newtheorem+ command formats a
theorem in \LaTeX's default style with italicized font, bold font
for theorem heading and theorem number at the right hand side of the
theorem heading.  It also optionally accepts an argument which
will be printed as an extra heading in parentheses. 

\begin{verbatim}
  \begin{theorem} 
   For system (8), consensus can be achieved with 
   $\|T_{\omega z}$ ...
     \begin{eqnarray}\label{10}
     ....
     \end{eqnarray}
  \end{theorem}
\end{verbatim}  


\newtheorem{theorem}{Theorem}

\begin{theorem}
For system (8), consensus can be achieved with 
$\|T_{\omega z}$ ...
\begin{eqnarray}\label{10}
....
\end{eqnarray}
\end{theorem}

The \verb+\newdefinition+ command is the same in
all respects as its \verb+\newtheorem+ counterpart except that
the font shape is roman instead of italic.  Both
\verb+\newdefinition+ and \verb+\newtheorem+ commands
automatically define counters for the environments defined.

The \verb+\newproof+ command defines proof environments with
upright font shape.  No counters are defined. 


\section[Enumerated ...]{Enumerated and Itemized Lists}
{cas-dc.cls} provides an extended list processing macros
which makes the usage a bit more user friendly than the default
\LaTeX{} list macros.   With an optional argument to the
\verb+\begin{enumerate}+ command, you can change the list counter
type and its attributes.

\begin{verbatim}
 \begin{enumerate}[1.]
 \item The enumerate environment starts with an optional
   argument `1.', so that the item counter will be suffixed
   by a period.
 \item You can use `a)' for alphabetical counter and '(i)' 
  for roman counter.
  \begin{enumerate}[a)]
    \item Another level of list with alphabetical counter.
    \item One more item before we start another.
    \item One more item before we start another.
    \item One more item before we start another.
    \item One more item before we start another.
\end{verbatim}

Further, the enhanced list environment allows one to prefix a
string like `step' to all the item numbers.  

\begin{verbatim}
 \begin{enumerate}[Step 1.]
  \item This is the first step of the example list.
  \item Obviously this is the second step.
  \item The final step to wind up this example.
 \end{enumerate}
\end{verbatim}

\section{Cross-references}
In electronic publications, articles may be internally
hyperlinked. Hyperlinks are generated from proper
cross-references in the article.  For example, the words
\textcolor{black!80}{Fig.~1} will never be more than simple text,
whereas the proper cross-reference \verb+\ref{tiger}+ may be
turned into a hyperlink to the figure itself:
\textcolor{blue}{Fig.~1}.  In the same way,
the words \textcolor{blue}{Ref.~[1]} will fail to turn into a
hyperlink; the proper cross-reference is \verb+\cite{Knuth96}+.
Cross-referencing is possible in \LaTeX{} for sections,
subsections, formulae, figures, tables, and literature
references.

\section{Bibliography}

Two bibliographic style files (\verb+*.bst+) are provided ---
{model1-num-names.bst} and {model2-names.bst} --- the first one can be
used for the numbered scheme. This can also be used for the numbered
with new options of {natbib.sty}. The second one is for the author year
scheme. When  you use model2-names.bst, the citation commands will be
like \verb+\citep+,  \verb+\citet+, \verb+\citealt+ etc. However when
you use model1-num-names.bst, you may use only \verb+\cite+ command.

\verb+thebibliography+ environment.  Each reference is a\linebreak
\verb+\bibitem+ and each \verb+\bibitem+ is identified by a label,
by which it can be cited in the text:

\noindent In connection with cross-referencing and
possible future hyperlinking it is not a good idea to collect
more that one literature item in one \verb+\bibitem+.  The
so-called Harvard or author-year style of referencing is enabled
by the \LaTeX{} package {natbib}. With this package the
literature can be cited as follows:

\begin{enumerate}[\textbullet]
\item Parenthetical: \verb+\citep{WB96}+ produces (Wettig \& Brown, 1996).
\item Textual: \verb+\citet{ESG96}+ produces Elson et al. (1996).
\item An affix and part of a reference:\break
\verb+\citep[e.g.][Ch. 2]{Gea97}+ produces (e.g. Governato et
al., 1997, Ch. 2).
\end{enumerate}

In the numbered scheme of citation, \verb+\cite{<label>}+ is used,
since \verb+\citep+ or \verb+\citet+ has no relevance in the numbered
scheme.  {natbib} package is loaded by {cas-dc} with
\verb+numbers+ as default option.  You can change this to author-year
or harvard scheme by adding option \verb+authoryear+ in the class
loading command.  If you want to use more options of the {natbib}
package, you can do so with the \verb+\biboptions+ command.  For
details of various options of the {natbib} package, please take a
look at the {natbib} documentation, which is part of any standard
\LaTeX{} installation.

\appendix
\section{My Appendix}
Appendix sections are coded under \verb+\appendix+.

\verb+\printcredits+ command is used after appendix sections to list 
author credit taxonomy contribution roles tagged using \verb+\credit+ 
in frontmatter.

\printcredits




%\vskip3pt

\bio{}
Author biography without author photo.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
\endbio

\bio{figs/pic1}
Author biography with author photo.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
\endbio

\bio{figs/pic1}
Author biography with author photo.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
Author biography. Author biography. Author biography.
\endbio

